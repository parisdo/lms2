"use strict";
var SingletonFilterService = (function () {
    function SingletonFilterService() {
        this.tags = {
            category: [],
            department: [],
            industry: [],
            language: []
        };
        this.checkAll = {
            industry: false,
            category: false,
            department: false,
            language: false
        };
        this.data = [];
        this.tempAllTag = [];
        this.tempDepartment = [];
        this.tempIndustry = [];
        this.tempLanguage = [];
        this.tempCategory = [];
        if (!SingletonFilterService.isCreating) {
            throw new Error("You can't call new in Singleton instances!");
        }
    }
    SingletonFilterService.getInstance = function () {
        if (SingletonFilterService.instance == null) {
            SingletonFilterService.isCreating = true;
            SingletonFilterService.instance = new SingletonFilterService();
            SingletonFilterService.isCreating = false;
        }
        return SingletonFilterService.instance;
    };
    SingletonFilterService.prototype.resetData = function () {
        this.data = [];
        this.tempAllTag = [];
        this.tempDepartment = [];
        this.tempIndustry = [];
        this.tempLanguage = [];
        this.tempCategory = [];
        return 'success reset data';
    };
    SingletonFilterService.prototype.setFilter = function (value, type, checked) {
        this.type = type;
        this.id = value;
        if (checked) {
            switch (type) {
                case 'department':
                    this.tempDepartment.push(value);
                    break;
                case 'industry':
                    this.tempIndustry.push(value);
                    break;
                case 'language':
                    this.tempLanguage.push(value);
                    break;
                case 'category':
                    this.tempCategory.push(value);
                    break;
            }
            return 'success set filter data';
        }
        if (!checked) {
            switch (type) {
                case 'department':
                    var department = this.tempDepartment.indexOf(value);
                    this.tempDepartment.splice(department, 1);
                    break;
                case 'industry':
                    var industry = this.tempIndustry.indexOf(value);
                    this.tempIndustry.splice(industry, 1);
                    break;
                case 'language':
                    var language = this.tempLanguage.indexOf(value);
                    this.tempLanguage.splice(language, 1);
                    break;
                case 'category':
                    var category = this.tempCategory.indexOf(value);
                    this.tempCategory.splice(category, 1);
                    break;
            }
            return 'success set filter data';
        }
        return 'reject';
    };
    SingletonFilterService.prototype.setAllData = function () {
        this.tempAllTag = [];
        if (this.type == 'category') {
            this.tempAllTag.push({ 'filter_by': 'category', 'value': this.id }, { 'type': 'department', 'value': this.tempDepartment }, { 'type': 'industry', 'value': this.tempIndustry }, { 'type': 'language', 'value': this.tempLanguage });
            this.data = this.tempAllTag;
            return 'all success';
        }
        else {
            this.tempAllTag.push({ 'filter_by': 'all', 'value': '' }, { 'type': 'department', 'value': this.tempDepartment }, { 'type': 'industry', 'value': this.tempIndustry }, { 'type': 'language', 'value': this.tempLanguage }, {
                'type': 'category', 'value': this.tempCategory
            });
            this.data = this.tempAllTag;
            return 'all success';
        }
    };
    SingletonFilterService.prototype.onCheckAllTag = function (type, event) {
        var _this = this;
        switch (type) {
            case 'department':
                this.tempDepartment = [];
                event.currentTarget.checked == true ? this.checkAll.department = true : this.checkAll.department = false;
                this.tags.department.forEach(function (tag) {
                    _this.setFilter(tag.dbid, tag.type, event);
                });
                break;
            case 'industry':
                this.tempIndustry = [];
                event.currentTarget.checked == true ? this.checkAll.industry = true : this.checkAll.industry = false;
                this.tags.industry.forEach(function (tag) {
                    _this.setFilter(tag.dbid, tag.type, event);
                });
                break;
            case 'language':
                this.tempLanguage = [];
                event.currentTarget.checked == true ? this.checkAll.language = true : this.checkAll.language = false;
                this.tags.language.forEach(function (tag) {
                    _this.setFilter(tag.dbid, tag.type, event);
                });
                break;
            case 'category':
                this.tempCategory = [];
                event.currentTarget.checked == true ? this.checkAll.category = true : this.checkAll.category = false;
                this.tags.category.forEach(function (tag) {
                    _this.setFilter(tag.dbid, tag.type, event);
                });
                break;
        }
        return 'success';
    };
    SingletonFilterService.prototype.getTags = function (type) {
    };
    SingletonFilterService.prototype.getData = function () {
        return this.data;
    };
    SingletonFilterService.prototype.getCheckAllType = function (type) {
        switch (type) {
            case 'department':
                return this.checkAll.department;
            case 'industry':
                return this.checkAll.industry;
            case 'language':
                return this.checkAll.language;
            case 'category':
                return this.checkAll.category;
        }
    };
    SingletonFilterService.isCreating = false;
    return SingletonFilterService;
}());
exports.SingletonFilterService = SingletonFilterService;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC9zaGFyZWQvc2VydmljZXMvZnVuY3Rpb24vZmlsdGVyLXByb2R1Y3Quc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7SUE2QkU7UUFyQk8sU0FBSSxHQUFRO1lBQ2pCLFFBQVEsRUFBRSxFQUFFO1lBQ1osVUFBVSxFQUFFLEVBQUU7WUFDZCxRQUFRLEVBQUUsRUFBRTtZQUNaLFFBQVEsRUFBRSxFQUFFO1NBQ2IsQ0FBQztRQUVLLGFBQVEsR0FBUTtZQUNyQixRQUFRLEVBQUUsS0FBSztZQUNmLFFBQVEsRUFBRSxLQUFLO1lBQ2YsVUFBVSxFQUFFLEtBQUs7WUFDakIsUUFBUSxFQUFFLEtBQUs7U0FDaEIsQ0FBQztRQUVGLFNBQUksR0FBVSxFQUFFLENBQUM7UUFDakIsZUFBVSxHQUFRLEVBQUUsQ0FBQztRQUNyQixtQkFBYyxHQUFRLEVBQUUsQ0FBQztRQUN6QixpQkFBWSxHQUFRLEVBQUUsQ0FBQztRQUN2QixpQkFBWSxHQUFRLEVBQUUsQ0FBQztRQUN2QixpQkFBWSxHQUFRLEVBQUUsQ0FBQztRQUdyQixFQUFFLENBQUMsQ0FBQyxDQUFDLHNCQUFzQixDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7WUFDdkMsTUFBTSxJQUFJLEtBQUssQ0FBQyw0Q0FBNEMsQ0FBQyxDQUFDO1FBQ2hFLENBQUM7SUFFSCxDQUFDO0lBRU0sa0NBQVcsR0FBbEI7UUFDRSxFQUFFLENBQUMsQ0FBQyxzQkFBc0IsQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQztZQUM1QyxzQkFBc0IsQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO1lBQ3pDLHNCQUFzQixDQUFDLFFBQVEsR0FBRyxJQUFJLHNCQUFzQixFQUFFLENBQUM7WUFDL0Qsc0JBQXNCLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQztRQUM1QyxDQUFDO1FBRUQsTUFBTSxDQUFDLHNCQUFzQixDQUFDLFFBQVEsQ0FBQztJQUN6QyxDQUFDO0lBRUQsMENBQVMsR0FBVDtRQUNFLElB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QUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUM7UUFFbEMsQ0FBQztJQUVILENBQUM7SUFsTU0saUNBQVUsR0FBWSxLQUFLLENBQUM7SUFxTXJDLDZCQUFDO0FBQUQsQ0F4TUEsQUF3TUMsSUFBQTtBQXhNWSw4QkFBc0IseUJBd01sQyxDQUFBIiwiZmlsZSI6ImFwcC9zaGFyZWQvc2VydmljZXMvZnVuY3Rpb24vZmlsdGVyLXByb2R1Y3Quc2VydmljZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBTaW5nbGV0b25GaWx0ZXJTZXJ2aWNlIHtcblxuICBzdGF0aWMgaW5zdGFuY2U6IFNpbmdsZXRvbkZpbHRlclNlcnZpY2U7XG4gIHN0YXRpYyBpc0NyZWF0aW5nOiBCb29sZWFuID0gZmFsc2U7XG5cbiAgdHlwZTogc3RyaW5nO1xuICBpZDogbnVtYmVyO1xuXG4gIHB1YmxpYyB0YWdzOiBhbnkgPSB7XG4gICAgY2F0ZWdvcnk6IFtdLFxuICAgIGRlcGFydG1lbnQ6IFtdLFxuICAgIGluZHVzdHJ5OiBbXSxcbiAgICBsYW5ndWFnZTogW11cbiAgfTtcblxuICBwdWJsaWMgY2hlY2tBbGw6IGFueSA9IHtcbiAgICBpbmR1c3RyeTogZmFsc2UsXG4gICAgY2F0ZWdvcnk6IGZhbHNlLFxuICAgIGRlcGFydG1lbnQ6IGZhbHNlLFxuICAgIGxhbmd1YWdlOiBmYWxzZVxuICB9O1xuXG4gIGRhdGE6IGFueVtdID0gW107XG4gIHRlbXBBbGxUYWc6IGFueSA9IFtdO1xuICB0ZW1wRGVwYXJ0bWVudDogYW55ID0gW107XG4gIHRlbXBJbmR1c3RyeTogYW55ID0gW107XG4gIHRlbXBMYW5ndWFnZTogYW55ID0gW107XG4gIHRlbXBDYXRlZ29yeTogYW55ID0gW107XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgaWYgKCFTaW5nbGV0b25GaWx0ZXJTZXJ2aWNlLmlzQ3JlYXRpbmcpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIllvdSBjYW4ndCBjYWxsIG5ldyBpbiBTaW5nbGV0b24gaW5zdGFuY2VzIVwiKTtcbiAgICB9XG5cbiAgfVxuXG4gIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcbiAgICBpZiAoU2luZ2xldG9uRmlsdGVyU2VydmljZS5pbnN0YW5jZSA9PSBudWxsKSB7XG4gICAgICBTaW5nbGV0b25GaWx0ZXJTZXJ2aWNlLmlzQ3JlYXRpbmcgPSB0cnVlO1xuICAgICAgU2luZ2xldG9uRmlsdGVyU2VydmljZS5pbnN0YW5jZSA9IG5ldyBTaW5nbGV0b25GaWx0ZXJTZXJ2aWNlKCk7XG4gICAgICBTaW5nbGV0b25GaWx0ZXJTZXJ2aWNlLmlzQ3JlYXRpbmcgPSBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gU2luZ2xldG9uRmlsdGVyU2VydmljZS5pbnN0YW5jZTtcbiAgfVxuXG4gIHJlc2V0RGF0YSgpe1xuICAgIHRoaXMuZGF0YSA9IFtdO1xuICAgIHRoaXMudGVtcEFsbFRhZyA9IFtdO1xuICAgIHRoaXMudGVtcERlcGFydG1lbnQgPSBbXTtcbiAgICB0aGlzLnRlbXBJbmR1c3RyeSA9IFtdO1xuICAgIHRoaXMudGVtcExhbmd1YWdlID0gW107XG4gICAgdGhpcy50ZW1wQ2F0ZWdvcnkgPSBbXTtcblxuICAgIHJldHVybiAnc3VjY2VzcyByZXNldCBkYXRhJztcbiAgfVxuXG5cbiAgc2V0RmlsdGVyKHZhbHVlOiBhbnksIHR5cGU6IHN0cmluZywgY2hlY2tlZDogYW55KSB7XG4gICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICB0aGlzLmlkID0gdmFsdWU7XG5cbiAgICBpZiAoY2hlY2tlZCkge1xuXG4gICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgY2FzZSAnZGVwYXJ0bWVudCc6XG4gICAgICAgICAgdGhpcy50ZW1wRGVwYXJ0bWVudC5wdXNoKHZhbHVlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnaW5kdXN0cnknOlxuICAgICAgICAgIHRoaXMudGVtcEluZHVzdHJ5LnB1c2godmFsdWUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdsYW5ndWFnZSc6XG4gICAgICAgICAgdGhpcy50ZW1wTGFuZ3VhZ2UucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2NhdGVnb3J5JzpcbiAgICAgICAgICB0aGlzLnRlbXBDYXRlZ29yeS5wdXNoKHZhbHVlKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuICdzdWNjZXNzIHNldCBmaWx0ZXIgZGF0YSc7XG5cbiAgICB9XG5cbiAgICBpZiAoIWNoZWNrZWQpIHtcblxuICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgJ2RlcGFydG1lbnQnOlxuICAgICAgICAgIGxldCBkZXBhcnRtZW50ID0gdGhpcy50ZW1wRGVwYXJ0bWVudC5pbmRleE9mKHZhbHVlKTtcbiAgICAgICAgICB0aGlzLnRlbXBEZXBhcnRtZW50LnNwbGljZShkZXBhcnRtZW50LCAxKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnaW5kdXN0cnknOlxuICAgICAgICAgIGxldCBpbmR1c3RyeSA9IHRoaXMudGVtcEluZHVzdHJ5LmluZGV4T2YodmFsdWUpO1xuICAgICAgICAgIHRoaXMudGVtcEluZHVzdHJ5LnNwbGljZShpbmR1c3RyeSwgMSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2xhbmd1YWdlJzpcbiAgICAgICAgICBsZXQgbGFuZ3VhZ2UgPSB0aGlzLnRlbXBMYW5ndWFnZS5pbmRleE9mKHZhbHVlKTtcbiAgICAgICAgICB0aGlzLnRlbXBMYW5ndWFnZS5zcGxpY2UobGFuZ3VhZ2UsIDEpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdjYXRlZ29yeSc6XG4gICAgICAgICAgbGV0IGNhdGVnb3J5ID0gdGhpcy50ZW1wQ2F0ZWdvcnkuaW5kZXhPZih2YWx1ZSk7XG4gICAgICAgICAgdGhpcy50ZW1wQ2F0ZWdvcnkuc3BsaWNlKGNhdGVnb3J5LCAxKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJldHVybiAnc3VjY2VzcyBzZXQgZmlsdGVyIGRhdGEnO1xuICAgIH1cblxuICAgIHJldHVybiAncmVqZWN0JztcblxuICB9XG5cbiAgc2V0QWxsRGF0YSgpIHtcbiAgICB0aGlzLnRlbXBBbGxUYWcgPSBbXTtcblxuICAgIGlmICh0aGlzLnR5cGUgPT0gJ2NhdGVnb3J5Jykge1xuICAgICAgdGhpcy50ZW1wQWxsVGFnLnB1c2goeydmaWx0ZXJfYnknOiAnY2F0ZWdvcnknLCAndmFsdWUnOiB0aGlzLmlkfSxcbiAgICAgICAgeyd0eXBlJzogJ2RlcGFydG1lbnQnLCAndmFsdWUnOiB0aGlzLnRlbXBEZXBhcnRtZW50fSxcbiAgICAgICAgeyd0eXBlJzogJ2luZHVzdHJ5JywgJ3ZhbHVlJzogdGhpcy50ZW1wSW5kdXN0cnl9LFxuICAgICAgICB7J3R5cGUnOiAnbGFuZ3VhZ2UnLCAndmFsdWUnOiB0aGlzLnRlbXBMYW5ndWFnZX1cbiAgICAgICk7XG4gICAgICB0aGlzLmRhdGEgPSB0aGlzLnRlbXBBbGxUYWc7XG4gICAgICByZXR1cm4gJ2FsbCBzdWNjZXNzJztcblxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRlbXBBbGxUYWcucHVzaCh7J2ZpbHRlcl9ieSc6ICdhbGwnLCAndmFsdWUnOiAnJ30sXG4gICAgICAgIHsndHlwZSc6ICdkZXBhcnRtZW50JywgJ3ZhbHVlJzogdGhpcy50ZW1wRGVwYXJ0bWVudH0sXG4gICAgICAgIHsndHlwZSc6ICdpbmR1c3RyeScsICd2YWx1ZSc6IHRoaXMudGVtcEluZHVzdHJ5fSxcbiAgICAgICAgeyd0eXBlJzogJ2xhbmd1YWdlJywgJ3ZhbHVlJzogdGhpcy50ZW1wTGFuZ3VhZ2V9LFxuICAgICAgICB7XG4gICAgICAgICAgJ3R5cGUnOiAnY2F0ZWdvcnknLCAndmFsdWUnOiB0aGlzLnRlbXBDYXRlZ29yeVxuICAgICAgICB9KTtcbiAgICAgIHRoaXMuZGF0YSA9IHRoaXMudGVtcEFsbFRhZztcbiAgICAgIHJldHVybiAnYWxsIHN1Y2Nlc3MnO1xuXG4gICAgfVxuXG5cbiAgfVxuXG4gIG9uQ2hlY2tBbGxUYWcodHlwZTogc3RyaW5nLCBldmVudDogYW55KSB7XG5cbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2UgJ2RlcGFydG1lbnQnOlxuICAgICAgICB0aGlzLnRlbXBEZXBhcnRtZW50ID0gW107XG4gICAgICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQuY2hlY2tlZCA9PSB0cnVlID8gdGhpcy5jaGVja0FsbC5kZXBhcnRtZW50ID0gdHJ1ZSA6IHRoaXMuY2hlY2tBbGwuZGVwYXJ0bWVudCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnRhZ3MuZGVwYXJ0bWVudC5mb3JFYWNoKCh0YWc6IGFueSkgPT4ge1xuICAgICAgICAgIHRoaXMuc2V0RmlsdGVyKHRhZy5kYmlkLCB0YWcudHlwZSwgZXZlbnQpO1xuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdpbmR1c3RyeSc6XG4gICAgICAgIHRoaXMudGVtcEluZHVzdHJ5ID0gW107XG4gICAgICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQuY2hlY2tlZCA9PSB0cnVlID8gdGhpcy5jaGVja0FsbC5pbmR1c3RyeSA9IHRydWUgOiB0aGlzLmNoZWNrQWxsLmluZHVzdHJ5ID0gZmFsc2U7XG4gICAgICAgIHRoaXMudGFncy5pbmR1c3RyeS5mb3JFYWNoKCh0YWc6IGFueSkgPT4ge1xuICAgICAgICAgIHRoaXMuc2V0RmlsdGVyKHRhZy5kYmlkLCB0YWcudHlwZSwgZXZlbnQpO1xuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdsYW5ndWFnZSc6XG4gICAgICAgIHRoaXMudGVtcExhbmd1YWdlID0gW107XG4gICAgICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQuY2hlY2tlZCA9PSB0cnVlID8gdGhpcy5jaGVja0FsbC5sYW5ndWFnZSA9IHRydWUgOiB0aGlzLmNoZWNrQWxsLmxhbmd1YWdlID0gZmFsc2U7XG4gICAgICAgIHRoaXMudGFncy5sYW5ndWFnZS5mb3JFYWNoKCh0YWc6IGFueSkgPT4ge1xuICAgICAgICAgIHRoaXMuc2V0RmlsdGVyKHRhZy5kYmlkLCB0YWcudHlwZSwgZXZlbnQpO1xuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdjYXRlZ29yeSc6XG4gICAgICAgIHRoaXMudGVtcENhdGVnb3J5ID0gW107XG4gICAgICAgIGV2ZW50LmN1cnJlbnRUYXJnZXQuY2hlY2tlZCA9PSB0cnVlID8gdGhpcy5jaGVja0FsbC5jYXRlZ29yeSA9IHRydWUgOiB0aGlzLmNoZWNrQWxsLmNhdGVnb3J5ID0gZmFsc2U7XG4gICAgICAgIHRoaXMudGFncy5jYXRlZ29yeS5mb3JFYWNoKCh0YWc6IGFueSkgPT4ge1xuICAgICAgICAgIHRoaXMuc2V0RmlsdGVyKHRhZy5kYmlkLCB0YWcudHlwZSwgZXZlbnQpO1xuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICB9XG5cbiAgICByZXR1cm4gJ3N1Y2Nlc3MnO1xuICB9XG5cblxuICBnZXRUYWdzKHR5cGU6IHN0cmluZyl7XG5cbiAgfVxuXG4gIGdldERhdGEoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YTtcbiAgfVxuXG4gIGdldENoZWNrQWxsVHlwZSh0eXBlOiBzdHJpbmcpIHtcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2UgJ2RlcGFydG1lbnQnOlxuICAgICAgICByZXR1cm4gdGhpcy5jaGVja0FsbC5kZXBhcnRtZW50O1xuICAgICAgY2FzZSAnaW5kdXN0cnknOlxuICAgICAgICByZXR1cm4gdGhpcy5jaGVja0FsbC5pbmR1c3RyeTtcbiAgICAgIGNhc2UgJ2xhbmd1YWdlJzpcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tBbGwubGFuZ3VhZ2U7XG4gICAgICBjYXNlICdjYXRlZ29yeSc6XG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNrQWxsLmNhdGVnb3J5O1xuXG4gICAgfVxuXG4gIH1cblxuXG59XG4iXX0=
